% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/easy_mergeMetabo.R
\name{easy_mergeMetabo}
\alias{easy_mergeMetabo}
\title{Merge Metabolomics Intensity and Identification Data (Single Mode)}
\usage{
easy_mergeMetabo(
  dat_intensity,
  dat_identification,
  mode,
  score_value,
  sampleInfo
)
}
\arguments{
\item{dat_intensity}{Data frame of intensity measurements (either positive or negative mode).
This should include compound annotation columns followed by raw intensity columns and normalized intensity columns.
The transition between raw and normalized sections is identified by column names "Raw.abundance" and "Normalised.abundance".}

\item{dat_identification}{Data frame of compound identification results for the same mode. Must contain columns like `Compound`, `Score`, `Fragmentation_Score`, `Description`, etc.}

\item{mode}{Character string, either `"pos"` or `"neg"`, indicating the polarity mode of the data.}

\item{score_value}{Numeric. The minimum MS1 Score cutoff. Only compounds with Score >= this value will be retained.}

\item{sampleInfo}{Data frame of sample information used to map original sample names to unique sample identifiers.
It should have columns `pos.name` (for positive mode sample names), `neg.name` (for negative mode sample names), and `unique.name` (unified sample names).}
}
\value{
A data frame with merged information for the given mode. Each row corresponds to a unique compound passing the score filter, including:
\itemize{
  \item Annotation and identification details (from the first part of \code{dat_intensity} and \code{dat_identification}).
  \item Raw intensity values for each sample (prefixed with "Raw_").
  \item Normalized intensity values for each sample (prefixed with "Norm_").
  \item A column "Polarity" indicating the mode ("pos" or "neg").
}
}
\description{
Merges metabolomic intensity data with identification data for a given polarity mode (positive or negative).
It filters identifications by a score threshold and combines them with the corresponding raw and normalized intensities.
}
\details{
The function cleans up column names in the intensity and identification data frames, ensures numeric columns are properly typed, and then:
  \enumerate{
    \item Selects the sample name mapping relevant to the mode (using `pos.name` or `neg.name` from `sampleInfo` to map to `unique.name`).
    \item Splits the intensity data into annotation, raw intensities, and normalized intensities sections.
    \item Renames the raw and normalized intensity columns to "Raw_[UniqueName]" and "Norm_[UniqueName]" using the `unique.name` from sampleInfo.
    \item Filters the identification data to keep only entries with Score above the cutoff and selects the top hit for each compound (and each description) based on the Score.
    \item Merges the filtered identification data with the intensity data by the Compound identifier.
    \item Sorts the merged entries by Fragmentation_Score (descending) and tags each with the polarity.
  }
The result is a combined table of identification and intensity for the given mode.
}
\examples{
\dontrun{
pos_combined <- easy_mergeMetabo(pos_intensity_df, pos_id_df, mode = "pos", score_value = 0.5, sampleInfo_df)
}
}
